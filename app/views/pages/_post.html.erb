<!-- post -->
<div class="row justify-content-center">
  <!-- scroll-percent-wrapper -->
  <button id="scroll-percent-wrapper" class="d-none text-muted btn btn-primary no-hover" style="position:fixed;bottom:1rem;left:1rem;cursor:default;z-index:1000;">
    <i style="font-style:normal;line-height:1;"><span id="scroll-percent"></span>%</i>
  </button>
  <!-- post details -->
  <div class="col-12 col-lg-<%= @size %>">
    <!-- meta -->
    <p class="text-muted m-0">
      <!-- draft -->
      <% if @draft %>
      <span>DRAFT &#9642;</span>
      <% end %>
      <!-- date -->
      <% unless @draft %>
      <span><%= Date.parse(@date).strftime("%b %d, %Y") %> &#9642;</span>
      <% end %>
      <!-- time to read -->
      <% @time_to_read = @words / 75 %>
      <span><%= @time_to_read %> min read (~<%= @words / 500 %> pages)</span>
      <!-- words -->
      <% if @draft %>
      <span style="float:right;">~<%= @words %> words</span>
      <% end %>
      <!-- tags -->
      <% if @tags %>
      <span>
        &#9642;
        <% @tags.each do |tag| %>
        <span>
          <% if tag == tag.upcase %>
          <%= tag %>
          <% elsif tag.include?('.') %>
          <%= tag.capitalize %>
          <% else %>
          <%= tag.titleize %>
          <% end %>
          <% unless tag.equal?(@tags.last) %>/ <% end %>
        </span>
        <% end %>
      </span>
      <% end %>
      <!-- updated -->
      <% unless Date.parse(@date) == Date.parse(@updated) %>
      <span>&#9642; <a href="https://github.com/michaelsjoeberg/michaelsjoeberg.com-4/commits/main/public/posts/<%= @post %>.md" target="_blank">Updated on <%= Date.parse(@updated).strftime("%b %d, %Y") %></a></span>
      <% end %>
    </p>
    <!-- title -->
    <h1 class="font-family-serif font-weight-bold <% if @toc%>my-3<% else %>mt-3<% end %>">
      <a href="/<%= @route_path %>/<%= @post %>" data-turbolinks="true"><%= @title %></a>
    </h1>
  </div>
  <!-- toc -->
  <% if @toc %>
  <div id="toc" class="col-12 col-lg-<%= @size %> font-family-serif">
    <div class="container-fluid mb-3 pb-3">
      <div class="row list border-solid--grey py-3 mb-3">
        <div class="col-12 split-columns p-0">
          <% @open = false %>
          <% @lines.each do |line| %>
            <% if line[0..2] == '## ' %>
              <!-- main on main headings are closed -->
              <% if @open %>
                <% @open = false %>
                </div>
              <% end %>
              <!-- main heading and open for potential subitems -->
              <div class="col-12 list-item">
                <% @open = true %>
                <%= CommonMarker.render_html("1. #{line.split('</a>')[1]}", :UNSAFE, [:table, :autolink]).html_safe %>
            <!-- subitem -->
            <% elsif line[0..3] == '### ' %>
                <div class="list-item subitem">
                  <%= CommonMarker.render_html("- #{line.split('</a>')[1]}", :UNSAFE, [:table, :autolink]).html_safe %>
                </div>
            <!-- subsubitem -->
            <% elsif line[0..4] == '#### ' || line[0..5] == '##### ' %>
                <div class="text-normal list-item subitem subsubitem pl-4">
                  <%= CommonMarker.render_html("- #{line.split('</a>')[1]}", :UNSAFE, [:table, :autolink]).html_safe %>
                </div>
            <% end %>
          <% end %><!-- .\each -->
          <!-- close at end -->
          <% if @open %>
              </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <% else %>
    <%= render 'divider', locals: { size: @size } %>
  <% end %>
  <!-- render post  -->
  <div class="col-12 col-lg-<%= @size %> font-family-serif">
    <%= CommonMarker.render_html(@all_lines, [:UNSAFE, :GITHUB_PRE_LANG], [:table, :autolink]).html_safe %>
  </div>
  <%= render 'divider' %>
  <div class="col-12 col-lg-<%= @size %> text-md-center">
    <p class="m-0"><a href="/writing" data-turbolinks="true">Browse all posts</a></p>
  </div>
</div>
<!-- mathjax -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<!-- ./post -->